<!--Signature modal-->
<div class="modal fade" id="sigModal" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="field-title"></h5>
        <button type="button" class="close border-0 bg-transparent" data-bs-dismiss="modal" aria-label="Close">
          <span class="text-black" aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>File integrity over time is verified with RSA signatures on SHA-256 hashes, calculated using <code>rsa.sign(json.dumps(data, sort_keys=True).encode('utf-8'), private_key, "SHA-256").hex()</code>, where <code>data</code> is the following Python dictionary representation of this exhibit:</p>
        <pre id="field-json-for-sig" class="bg-dark text-light"></pre>
        <p>The signature may be independantly verified with <code>rsa.verify(data, bytes.fromhex(signature), public_key)</code>, where <code>public_key</code> is the public key corresponding to the user's private key. The user's public key is available in <a href="{{ target_user.py_cert_permalink }}" target="_blank">python</a> and <a href="{{ target_user.pem_cert_permalink }}" target="_blank">pem</a> formats.</p>
        <pre></pre>
        <p>User's signature generated from the user's private key and saved at the time of signing (<span id="field-signed-string"></span>):<br><code id="field-rsa-signature"></code></p>
        <p>Does this signature match the live data and the public key?<i id="sig-match-icon" class="fas fa-fw"></i><span id="sig-match-text"></span></p>
      </div>
      <div class="modal-footer">
        <p id="display-sig-valid" class="me-auto"><i class="text-success fas fa-signature-lock"></i> This exhibit was signed by {{ target_user.username }}, and has not been altered since it was signed.</p>
        <p id="display-sig-invalid" class="me-auto d-none"><i class="text-danger fas fa-signature-slash"></i> This exhibit may have been altered since it was signed.</p>
        <button type="button" class="btn btn-primary ms-auto" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>